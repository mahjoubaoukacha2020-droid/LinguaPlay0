import streamlit as st
import openai
from gtts import gTTS
import os

# Ø¶Ø¹ Ù‡Ù†Ø§ Ù…ÙØªØ§Ø­ OpenAI Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
openai.api_key = "YOUR_OPENAI_API_KEY"

st.set_page_config(page_title="ğŸŒ LinguaPlay Ultra Max", layout="wide")
st.title("ğŸŒ Ù…Ù†ØµØ© Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù„ØºØ§Øª Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ")

# Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ØºØ©
language = st.selectbox("Ø§Ø®ØªØ± Ø§Ù„Ù„ØºØ©:", ["English", "FranÃ§ais", "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©", "Darija (Moroccan)"])

# Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†Øµ
user_input = st.text_input("Ø§ÙƒØªØ¨ Ø¬Ù…Ù„Ø© Ù„ØªØ¹Ù„Ù…Ù‡Ø§ Ø£Ùˆ ØªØ±Ø¬Ù…ØªÙ‡Ø§:")

if st.button("ØªØ±Ø¬Ù… ÙˆØªØ­Ø¯Ø«"):
    if user_input:
        prompt = f"Translate this sentence to {language} and explain it simply: {user_input}"
        response = openai.Completion.create(
            engine="text-davinci-003",
            prompt=prompt,
            max_tokens=150
        )
        translation = response.choices[0].text.strip()
        st.success(translation)

        # ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ ØµÙˆØª
        tts = gTTS(translation, lang="en")
        tts.save("output.mp3")
        audio_file = open("output.mp3", "rb")
        st.audio(audio_file.read(), format="audio/mp3")
        os.remove("output.mp3")
